<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.kh.earth.admin.model.dao.AdminMapper">

	<resultMap type="Report" id="ReportListResultMap">
		<id property="reportNo" column="REPORT_NO"/>
		<result property="reportMemberNo" column="REPORT_M_NO"/>
		<result property="reportedMemberNo" column="REPORTED_M_NO"/>
		<result property="reportDate" column="REPORT_DATE"/>
		<result property="reportTitle" column="REPORT_TITLE"/>
		<result property="reportContent" column="REPORT_CONTENT"/>
		<result property="reportCategory" column="REPORT_CATEGORY"/>
		<result property="reportStatus" column="REPORT_STATUS"/>
		<result property="reportMemberName" column="REPORT_M_NAME"/>
		<result property="reportedMemberName" column="REPORTED_M_NAME"/>
	</resultMap>
	
	<resultMap type="Member" id="memberResultMap">
		<id property="no" column="NO"/>
		<result property="id" column="ID"/>
		<result property="password" column="PASSWORD"/>
		<result property="member_type" column="MEMBER_TYPE"/>
		<result property="name" column="NAME"/>
		<result property="phone" column="PHONE"/>
		<result property="email" column="EMAIL"/>
		<result property="address" column="ADDRESS"/>
		<result property="platform_type" column="PLATFORM_TYPE"/>
		<result property="status" column="STATUS"/>
		<result property="img_name" column="IMG_NAME"/>	
		<result property="modify_img_name" column="MODIFY_IMG_NAME"/>		
		<result property="enrollDate" column="ENROLL_DATE"/>
		<result property="modifyDate" column="MODIFY_DATE"/>
		<result property="reportedTimes" column="REPORTED"/>
	</resultMap>
	
	<resultMap type="Product" id="ProductListResultMap">
		<id property="proNo" column="PRO_NO"/>
		<result property="proName" column="PRO_NAME"/>
		<result property="proPrice" column="PRO_PRICE"/>
		<result property="proDate" column="PRO_DATE"/>
		<result property="proModifyDate" column="PRO_MODIFY_DATE"/>
		<result property="proVol" column="PRO_VOL"/>
		<result property="proImg" column="PRO_IMG"/>
		<result property="proModifyImg" column="PRO_MODIFY_IMG"/>
		<result property="proInfo" column="PRO_INFO"/>
		<result property="proStat" column="PRO_STAT"/>
		<result property="proCat" column="PRO_CAT"/>
		<result property="proSold" column="PRO_SOLD"/>
		<result property="proStock" column="PRO_STOCK"/>
		<result property="proMfg" column="PRO_MFG"/>
		<result property="proRating" column="PRO_RATING"/>
	</resultMap>
	
	<resultMap type="ProductInquiry" id="ProductInqListResultMap">
		<id property="proNo" column="PRO_NO"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="inqNo" column="INQ_NO"/>
		<result property="proDate" column="PRO_DATE"/>
		<result property="inqDate" column="INQ_DATE"/>
		<result property="inqModDate" column="INQ_MOD_DATE"/>
		<result property="inqTitle" column="INQ_TITLE"/>
		<result property="inqContent" column="INQ_CONTENT"/>
		<result property="inqStat" column="INQ_STAT"/>
		<result property="inqSecret" column="INQ_SECRET"/>
	</resultMap>
	
	<resultMap type="Today" id="TodayListResultMap">
		<id property="chalNo" column="CHAL_NO"/>
		<result property="category" column="CATEGORY"/>
		<result property="chalTitle" column="CHAL_TITLE"/>
		<result property="chalContent" column="CHAL_CONTENT"/>
		<result property="originalFilename" column="ORIGINAL_FILENAME"/>
		<result property="renamedFilename" column="RENAMED_FILENAME"/>
		<result property="chalPoint" column="CHAL_POINT"/>
		<result property="startDate" column="START_DATE"/>
		<result property="endDate" column="END_DATE"/>
		<result property="chalStatus" column="CHAL_STATUS"/>
	</resultMap>
	
	<resultMap type="Month" id="MonthListResultMap">
		<id property="chalNo" column="CHAL_NO"/>
		<result property="category" column="CATEGORY"/>
		<result property="chalTitle" column="CHAL_TITLE"/>
		<result property="chalContent" column="CHAL_CONTENT"/>
		<result property="originalFilename" column="ORIGINAL_FILENAME"/>
		<result property="renamedFilename" column="RENAMED_FILENAME"/>
		<result property="chalPoint" column="CHAL_POINT"/>
		<result property="chalCount" column="CHAL_COUNT"/>
		<result property="startDate" column="START_DATE"/>
		<result property="endDate" column="END_DATE"/>
		<result property="chalStatus" column="CHAL_STATUS"/>
	</resultMap>
	
	<resultMap type="MonthMember" id="MonthMemListResultMap">
		<id property="no" column="NO"/>
		<result property="memNo" column="MEM_NO"/>
		<result property="chalNo" column="CHAL_NO"/>
		<result property="chalDate" column="CHAL_DATE"/>
		<result property="originalFilename" column="ORIGINAL_FILENAME"/>
		<result property="renamedFilename" column="RENAMED_FILENAME"/>
		<result property="chalStatus" column="CHAL_STATUS"/>
		<result property="chalPoint" column="CHAL_POINT"/>
		<result property="chalPointStatus" column="CHAL_POINT_STATUS"/>
	</resultMap>
	
	<resultMap type="TodayMember" id="TodayMemListResultMap">
		<id property="no" column="NO"/>
		<result property="memNo" column="MEM_NO"/>
		<result property="chalNo" column="CHAL_NO"/>
		<result property="chalDate" column="CHAL_DATE"/>
		<result property="originalFilename" column="ORIGINAL_FILENAME"/>
		<result property="renamedFilename" column="RENAMED_FILENAME"/>
		<result property="chalStatus" column="CHAL_STATUS"/>
		<result property="chalPoint" column="CHAL_POINT"/>
		<result property="chalPointStatus" column="CHAL_POINT_STATUS"/>
	</resultMap>
	
	<resultMap type="Reported" extends="memberResultMap" id="ReportedListResultMap">
		<result property="reportedTimes" column="REPORTED"/>
	</resultMap>
	
	<resultMap type="Notice" id="noticeListResultMap">
		<id property="no" column="NOTICE_NO"/>
		<result property="writerNo" column="WRITER_NO"/>
		<result property="writerId" column="ID"/>
		<result property="title" column="NOTICE_TIT"/>
		<result property="content" column="NOTICE_CONTENT"/>
		<result property="readCount" column="NOTICE_COUNT"/>
		<result property="originalFileName" column="ORIGINAL_FILENAME"/>
		<result property="renamedFileName" column="RENAMED_FILENAME"/>
		<result property="createDate" column="DATE_WRITEN"/>
		<result property="modifyDate" column="DATE_WRITEN_MODIFY"/>
		<result property="status" column="NOTICE_STATUS"/>
	</resultMap>
	
	<resultMap type="Qna" id="qnaListResultMap">
		<id property="no" column="QNA_NO"/>
		<result property="writerNo" column="WRITER_NO"/>
		<result property="title" column="QNA_TIT"/>
		<result property="categoryNo" column="QNA_CAT"/>
		<result property="content" column="QNA_CONTENT"/>
		<result property="readCount" column="QNA_COUNT"/>
		<result property="originalFileName" column="ORIGINAL_FILENAME"/>
		<result property="renamedFileName" column="RENAMED_FILENAME"/>
		<result property="createDate" column="DATE_WRITEN"/>
		<result property="modifyDate" column="DATE_WRITEN_MODIFY"/>
		<result property="status" column="QNA_STATUS"/>
		<result property="category" column="C_NAME"/>
	</resultMap>
	
	<resultMap type="QnaAnswer" extends="qnaListResultMap" id="qnaAnswerListResultMap">
		<id property="answerNo" column="ANSWER_NO"/>
		<result property="qnaNo" column="QNA_NO"/>
		<result property="writerNo" column="WRITER_NO"/>
		<result property="answerContent" column="ANSWER_CONTENT"/>
		<result property="answerDate" column="ANSWER_DATE"/>
		<result property="answerStatus" column="ANSWER_STATUS"/>
	</resultMap>
	
	<resultMap type="OrderSum" id="OrderSumResultMap">
		<id property="orderNo" column="ORDER_NO"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="orderPrice" column="ORDER_PRICE"/>
		<result property="orderStat" column="ORDER_STAT"/>
		<result property="orderDate" column="ORDER_DATE"/>
		<result property="orderMethod" column="ORDER_METHOD"/>
		<result property="orderPm" column="ORDER_PM"/>
		<result property="orderPoint" column="ORDER_POINT"/>
	</resultMap>
	
	<resultMap type="OrderDetail" id="OrderDetailResultMap">
		<id property="orderNo" column="ORDER_NO"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="detailProNo" column="DETAIL_PRO_NO"/>
		<result property="detailProName" column="DETAIL_PRO_NAME"/>
		<result property="detailOpt" column="DETAIL_OPT"/>
		<result property="detailOptName" column="DETAIL_OPT_NAME"/>
		<result property="detailQty" column="DETAIL_QTY"/>
		<result property="detailPrice" column="DETAIL_PRICE"/>
	</resultMap>
	
	<resultMap type="Application" id="ApplicationListResultMap">
        <id property="appNo" column="A_APP_NO"/>
        <result property="memberNo" column="A_MEMBER_NO"/>
        <result property="appName" column="A_APP_NAME"/>
        <result property="appUrl" column="A_APP_URL"/>
        <result property="appTitle" column="A_APP_TITLE"/>
        <result property="appContent" column="A_APP_CONTENT"/>
        <result property="appStatNo" column="A_APP_S_NO"/>
        <result property="appCatNo" column="A_APP_C_NO"/>
        <result property="appCatName" column="P_C_NAME"/>
        <result property="appDate" column="A_APP_DATE"/>
    </resultMap>
	
	<sql id="selectNoticeSql">
		SELECT  NOTICE_NO, 
				WRITER_NO, 
		        NOTICE_TIT, 
		        NOTICE_CONTENT, 
		        NOTICE_COUNT, 
		        ORIGINAL_FILENAME, 
		        RENAMED_FILENAME, 
		        DATE_WRITEN, 
		        DATE_WRITEN_MODIFY, 
		        NOTICE_STATUS 
		FROM NOTICE
		ORDER BY DECODE(NOTICE_STATUS, 'Y', 1), NOTICE_NO DESC
	</sql>
	
	<sql id="selectReportSql">
		SELECT REPORT_NO, 
			    REPORT_M_NO, 
			    REPORTED_M_NO, 
			    REPORT_DATE,
			    REPORT_TITLE, 
			    REPORT_CONTENT, 
			    REPORT_STATUS, 
			    REPORT_CATEGORY
	</sql>
	
	<sql id="selectMemberSql">
		SELECT NO, 
		    ID, 
		    PASSWORD, 
		    MEMBER_TYPE, 
		    NAME, 
		    PHONE, 
		    EMAIL, 
		    ADDRESS, 
		    PLATFORM_TYPE, 
		    STATUS, 
		    IMG_NAME, 
		    MODIFY_IMG_NAME, 
		    ENROLL_DATE, 
		    MODIFY_DATE
	</sql>
	
	<sql id="selectProductSql">
		SELECT PRO_NO,
			   PRO_NAME,
			   PRO_PRICE, 
			   PRO_DATE, 
			   PRO_MODIFY_DATE, 
			   PRO_VOL, 
			   PRO_IMG, 
			   PRO_MODIFY_IMG, 
			   PRO_INFO, 
			   PRO_STAT,
			   PRO_CAT, 
			   PRO_STOCK, 
			   PRO_SOLD, 
			   PRO_MFG, 
			   PRO_RATING
	</sql>
	
	<select id="getMemberCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
	    FROM MEMBER
	    <where>
			<if test="name != null">
		   		NAME LIKE '%' || #{name} || '%'
			</if>
			<if test="id != null">
		   		ID LIKE '%' || #{id} || '%'
			</if>
			<if test="no != null">
		   		NO LIKE '%' || #{no} || '%'
			</if>
		</where>
	</select>
	
	<select id="getMemberList" parameterType="map" resultMap="memberResultMap">
		<include refid="selectMemberSql" />
		FROM MEMBER
		<where>
			<if test="name != null">
		   		NAME LIKE '%' || #{name} || '%'
			</if>
			<if test="id != null">
		   		ID LIKE '%' || #{id} || '%'
			</if>
			<if test="no != null">
		   		NO LIKE '%' || #{no} || '%'
			</if>
		</where>
		ORDER BY DECODE(STATUS, 'Y', 1), NO DESC
	</select>
	
	<delete id="deleteMember" parameterType="_int">
  		UPDATE MEMBER
  		SET
  			STATUS = 'N'
  		WHERE 
  			NO = #{no}
  	</delete>

	<select id="getReportCount" resultType="_int" parameterType="map" >
	SELECT COUNT(*)
	FROM REPORT R
	JOIN MEMBER M1 ON(R.REPORTED_M_NO = M1.NO)
    JOIN MEMBER M2 ON(R.REPORT_M_NO = M2.NO)
    <choose>
		   	<when test="no != null">
		   		AND REPORT_NO LIKE '%' || #{no} || '%'
		   	</when>
			<when test="name != null">
		   		AND M2.NAME LIKE '%' || #{name} || '%'
		   	</when>
		   	<when test="name2 != null">
		   		AND M1.NAME LIKE '%' || #{name2} || '%'
		   	</when>
		</choose>
	</select>
	
	<select id="getReportList" resultMap="ReportListResultMap">
		SELECT R.REPORT_NO, 
			   R.REPORT_M_NO, 
			   R.REPORTED_M_NO, 
			    R.REPORT_DATE,
			    R.REPORT_TITLE, 
			    R.REPORT_CONTENT, 
			    R.REPORT_STATUS, 
			    R.REPORT_CATEGORY,
			    M1.NAME AS REPORTED_M_NAME,
			    M2.NAME AS REPORT_M_NAME
		FROM REPORT R
		JOIN MEMBER M1 ON(R.REPORTED_M_NO = M1.NO)
		JOIN MEMBER M2 ON(R.REPORT_M_NO = M2.NO)
		WHERE REPORT_STATUS = 'Y'
		<choose>
		   	<when test="no != null">
		   		AND REPORT_NO LIKE '%' || #{no} || '%'
		   	</when>
			<when test="name != null">
		   		AND M2.NAME LIKE '%' || #{name} || '%'
		   	</when>
		   	<when test="name2 != null">
		   		AND M1.NAME LIKE '%' || #{name2} || '%'
		   	</when>
		</choose>
		ORDER BY REPORT_NO DESC
	</select>
	
	<select id="getReportDetail" parameterType="_int" resultMap="ReportListResultMap">
		SELECT REPORT_NO, 
			    REPORT_M_NO, 
			    REPORTED_M_NO, 
			    REPORT_DATE,
			    REPORT_TITLE, 
			    REPORT_CONTENT, 
			    REPORT_STATUS, 
			    REPORT_CATEGORY
			FROM REPORT
			WHERE REPORT_NO = #{ no }
	</select>

	<delete id="deleteReport" parameterType="_int">
  		UPDATE REPORT
  		SET
  			REPORT_STATUS = 'N'
  		WHERE 
  			REPORT_NO = #{no}
  	</delete>
	
	<select id="getReportedCount" resultType="_int">
		SELECT COUNT(*) FROM(
				SELECT NO, 
		       MEMBER_TYPE, 
		       NAME,
		       (SELECT COUNT(NO) FROM REPORT WHERE (REPORTED_M_NO)=NO) AS REPORTED
			FROM MEMBER
			WHERE NO IN(SELECT REPORTED_M_NO
				        FROM REPORT)
			AND STATUS = 'Y')
	</select>
	
	<select id="getReportedList" parameterType="map" resultMap="ReportedListResultMap">
		SELECT NO, 
		       MEMBER_TYPE, 
		       NAME, 
		       STATUS,
		       ENROLL_DATE,
		       (SELECT COUNT(NO) FROM REPORT WHERE (REPORTED_M_NO)=NO) AS REPORTED
			FROM MEMBER
			WHERE NO IN(SELECT REPORTED_M_NO
				        FROM REPORT)
		<choose>
		   	<when test="name != null">
		   		AND NAME LIKE '%' || #{name} || '%'
		   	</when>
		</choose>
			ORDER BY REPORTED DESC
	</select>
	
	<select id="getNoticeCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
	    FROM NOTICE
	    <where>
			<if test="no != null">
		   		NOTICE_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="title != null">
		   		NOTICE_TIT LIKE '%' || #{title} || '%'
			</if>
			<if test="writerNo != null">
		   		WRITER_NO LIKE '%' || #{writerNo} || '%'
			</if>
		</where>
	</select>
	
	<select id="getNoticeList" parameterType="map" resultMap="noticeListResultMap">
		<include refid="selectNoticeSql" />
	</select>
	
	<select id="findNoticeByNo" parameterType="_int" resultMap="noticeListResultMap">
		SELECT  NOTICE_NO, 
				WRITER_NO, 
		        NOTICE_TIT, 
		        NOTICE_CONTENT, 
		        NOTICE_COUNT, 
		        ORIGINAL_FILENAME, 
		        RENAMED_FILENAME, 
		        DATE_WRITEN, 
		        DATE_WRITEN_MODIFY, 
		        NOTICE_STATUS 
		FROM NOTICE
		WHERE NOTICE_NO = #{ no }
	</select>
	
	<update id="deleteNotice" parameterType="_int">
	UPDATE NOTICE
	 	SET NOTICE_STATUS = 'N'
	 	WHERE NOTICE_NO = #{no}
	 </update>
	
	<update id="updateNotice" parameterType="_int">
	UPDATE NOTICE
	<trim prefix="SET" suffixOverrides=",">
	 	<if test="title != null">
	 		NOTICE_TIT = #{title},
	 	</if>
	 	<if test="content != null">
	 		NOTICE_CONTENT = #{content},
		</if>
		<if test="originalFileName != null">
	 		ORIGINAL_FILENAME = #{originalFileName},
		</if>
	 	<if test="renamedFileName != null">
	 		RENAMED_FILENAME = #{renamedFileName},
		</if>
	 		DATE_WRITEN_MODIFY=SYSDATE
	</trim>
	 	WHERE
	 		NOTICE_NO = #{no}
	 </update>
	 
	 <insert id="writeNotice" parameterType="Notice"
	 	useGeneratedKeys="true" keyProperty="no" keyColumn="NOTICE_NO">
	 	INSERT INTO NOTICE(
	 		NOTICE_NO,
	 		WRITER_NO,
	 		NOTICE_TIT,
	 		NOTICE_CONTENT,
	 		ORIGINAL_FILENAME,
	 		RENAMED_FILENAME,
	 		DATE_WRITEN,
	 		DATE_WRITEN_MODIFY,
	 		NOTICE_STATUS
	 	) VALUES(
	 		SEQ_NOTICE_NO.NEXTVAL,
	 		#{writerNo},
	 		#{title},
	 		#{content},
	 		#{originalFileName},
	 		#{renamedFileName},
	 		DEFAULT,
	 		DEFAULT,
	 		DEFAULT
	 	)
	 </insert>
	 
	 <select id="getQnaCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
	    FROM QNA
	    <where>
	    	QNA_STATUS = 'Y'
			<if test="no != null">
		   		AND Q.QNA_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND Q.QNA_TIT LIKE '%' || #{name} || '%'
			</if>
			<if test="category != null">
		   		AND QC.C_NAME LIKE '%' || #{category} || '%'
			</if>
		</where>
		ORDER BY DATE_WRITEN DESC
	</select>
	
	<select id="getQnaList" parameterType="map" resultMap="qnaListResultMap">
		SELECT      Q.QNA_NO, 
		            Q.WRITER_NO, 
		            Q.QNA_TIT, 
		            Q.QNA_CAT, 
		            Q.QNA_CONTENT, 
		            Q.QNA_COUNT, 
		            Q.ORIGINAL_FILENAME, 
		            Q.RENAMED_FILENAME, 
		            Q.DATE_WRITEN, 
		            Q.DATE_WRITEN_MODIFY, 
		            Q.QNA_STATUS,
		            QC.C_NAME
		FROM QNA Q
        JOIN QNA_CATEGORY QC ON(QNA_CAT = QC.C_NO)
        <where>
		Q.QNA_STATUS = 'Y'
			<if test="no != null">
		   		AND Q.QNA_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND Q.QNA_TIT LIKE '%' || #{name} || '%'
			</if>
			<if test="category != null">
		   		AND QC.C_NAME LIKE '%' || #{category} || '%'
			</if>
		</where>
		ORDER BY Q.QNA_NO DESC
	</select>
	
	<select id="getAnswerByNo" parameterType="map" resultMap="qnaAnswerListResultMap">
		 SELECT QA.ANSWER_CONTENT
		    FROM QNA_ANSWER QA
		    JOIN QNA Q ON(QA.QNA_NO = Q.QNA_NO)
		    ORDER BY Q.QNA_NO DESC
	</select>
	
	<insert id="answerQna" parameterType="QnaAnswer"
         useGeneratedKeys="true" keyProperty="answerNo" keyColumn="ANSWER_NO">
         INSERT INTO QNA_ANSWER(
             ANSWER_NO,
             QNA_NO,
             WRITER_NO,
             ANSWER_CONTENT,
             ANSWER_STATUS,
             ANSWER_DATE
         ) VALUES(
             SEQ_QNA_ANSWER.NEXTVAL,
             #{qnaNo},
             #{writerNo},
             #{answerContent},
             DEFAULT,
             DEFAULT
         )
     </insert>
     
     <update id="updateQna" parameterType="_int">
	UPDATE QNA_ANSWER
	 	SET 
	 		ANSWER_CONTENT = #{answerContent},
	 		ANSWER_DATE = SYSDATE
	 	WHERE 
	 		ANSWER_NO = #{answerNo}
	 </update>
	
	<select id="findQnaByNo" parameterType="Qna" resultMap="qnaListResultMap">
		SELECT 	QNA_NO,
				WRITER_NO,
				QNA_TIT,
				QNA_CAT,
				QNA_CONTENT,
				QNA_COUNT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				DATE_WRITEN,
				DATE_WRITEN_MODIFY,
				QNA_STATUS
		FROM QNA
		WHERE QNA_NO = #{ no }
	</select>
	
	<select id="getQnaDoneCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
	    FROM QNA
	    <where>
	    	QNA_STATUS = 'N'
			<if test="no != null">
		   		AND Q.QNA_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND Q.QNA_TIT LIKE '%' || #{name} || '%'
			</if>
			<if test="category != null">
		   		AND QC.C_NAME LIKE '%' || #{category} || '%'
			</if>
		</where>
		ORDER BY DATE_WRITEN DESC
	</select>
	
	<select id="getQnaDoneList" parameterType="map" resultMap="qnaAnswerListResultMap">
		SELECT      Q.QNA_NO, 
		            Q.WRITER_NO, 
		            Q.QNA_TIT, 
		            Q.QNA_CAT, 
		            Q.QNA_CONTENT, 
		            Q.QNA_COUNT, 
		            Q.ORIGINAL_FILENAME, 
		            Q.RENAMED_FILENAME, 
		            Q.DATE_WRITEN, 
		            Q.DATE_WRITEN_MODIFY, 
		            Q.QNA_STATUS,
		            QC.C_NAME,
                    QA.ANSWER_CONTENT,
                    QA.ANSWER_DATE
		FROM QNA Q
        JOIN QNA_CATEGORY QC ON(Q.QNA_CAT = QC.C_NO)
        JOIN QNA_ANSWER QA ON(QA.QNA_NO = Q.QNA_NO)
		<where>
		Q.QNA_STATUS = 'N'
			<if test="no != null">
		   		AND Q.QNA_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND Q.QNA_TIT LIKE '%' || #{name} || '%'
			</if>
			<if test="category != null">
		   		AND QC.C_NAME LIKE '%' || #{category} || '%'
			</if>
		</where>
		ORDER BY Q.QNA_NO DESC
	</select>
	
	<update id="qnaDone" parameterType="_int">
	UPDATE QNA
	 	SET 
	 		QNA_STATUS = 'N'
	 	WHERE 
	 		QNA_NO = #{no}
	 </update>
	
	<select id="getTodayCount" resultType="_int" parameterType="map">
		SELECT COUNT(*) FROM CHAL_TODAY
		<where>
			<if test="no != null">
		   		CHAL_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		CHAL_TITLE LIKE '%' || #{name} || '%'
			</if>
			<if test="point != null">
		   		CHAL_POINT LIKE '%' || #{point} || '%'
			</if>
		</where>
	</select>
	
	<select id="getTodayList" parameterType="map" resultMap="TodayListResultMap">
		SELECT  CHAL_NO,
				CATEGORY,
				CHAL_TITLE,
				CHAL_CONTENT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				START_DATE,
				END_DATE,
				CHAL_STATUS
		FROM CHAL_TODAY
		<where>
			<if test="no != null">
		   		CHAL_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		CHAL_TITLE LIKE '%' || #{name} || '%'
			</if>
			<if test="point != null">
		   		CHAL_POINT LIKE '%' || #{point} || '%'
			</if>
		</where>
		ORDER BY CHAL_NO DESC
	</select>

	<insert id="insertToday" parameterType="Today"
	 	useGeneratedKeys="true" keyProperty="chalNo" keyColumn="CHAL_NO">
	 	INSERT INTO CHAL_TODAY(
	 		CHAL_NO,
	 		CATEGORY,
	 		CHAL_TITLE,
	 		CHAL_CONTENT,
	 		ORIGINAL_FILENAME,
	 		RENAMED_FILENAME,
	 		CHAL_POINT,
	 		START_DATE,
	 		END_DATE,
	 		CHAL_STATUS
	 	) VALUES(
	 		SEQ_CHAL_TODAY.NEXTVAL,
	 		1,
	 		#{chalTitle},
	 		#{chalContent},
	 		#{originalFilename},
	 		#{renamedFilename},
	 		#{chalPoint},
	 		#{startDate},
	 		#{endDate},
	 		DEFAULT
	 	)
	 </insert>
	
	<select id="findTodayByNo" parameterType="Today" resultMap="TodayListResultMap">
		SELECT 	CHAL_NO,
				CATEGORY,
				CHAL_TITLE,
				CHAL_CONTENT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				START_DATE,
				END_DATE
		FROM CHAL_TODAY
		WHERE CHAL_NO = #{ chalNo }
	</select>
	
	<update id="updateToday" parameterType="Today">
	UPDATE CHAL_TODAY
	<trim prefix="SET" suffixOverrides=",">
	 	<if test="category != null">
	 		CATEGORY = #{category},
	 	</if>
	 	<if test="chalTitle != null">
	 		CHAL_TITLE = #{chalTitle},
		</if>
		<if test="chalContent != null">
	 		CHAL_CONTENT = #{chalContent},
		</if>
	 	<if test="originalFilename != null">
	 		ORIGINAL_FILENAME = #{originalFilename},
		</if>
		<if test="renamedFilename != null">
	 		RENAMED_FILENAME = #{renamedFilename},
		</if>
	 	<if test="chalPoint != null">
	 		CHAL_POINT = #{chalPoint},
	 	</if>
	 	<if test="startDate != null">
	 		START_DATE = #{startDate},
		</if>
		<if test="endDate != null">
	 		END_DATE = #{endDate},
		</if>
		<if test="chalStatus != null">
	 		CHAL_STATUS = 'Y',
		</if>
	</trim>
	 	WHERE CHAL_NO = #{chalNo}
	 </update>
  	
	<delete id="deleteToday" parameterType="_int">
  		UPDATE CHAL_TODAY
  		SET
  			CHAL_STATUS = 'N'
  		WHERE 
  			CHAL_NO = #{no}
  	</delete>

	<delete id="deleteProduct" parameterType="_int">
  		UPDATE PRODUCT
  		SET
  			PRO_STAT = 1
  		WHERE 
  			PRO_NO = #{no}
  	</delete>
	
	<select id="getMonthCount" resultType="_int">
		SELECT COUNT(*) FROM CHAL_MONTH
		<where>
			<if test="no != null">
		   		CHAL_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		CHAL_TITLE LIKE '%' || #{name} || '%'
			</if>
			<if test="point != null">
		   		CHAL_POINT LIKE '%' || #{point} || '%'
			</if>
		</where>
	</select>
	
	<select id="getMonthList" parameterType="map" resultMap="MonthListResultMap">
		SELECT  CHAL_NO,
				CATEGORY,
				CHAL_TITLE,
				CHAL_CONTENT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				CHAL_COUNT,
				START_DATE,
				END_DATE,
				CHAL_STATUS
		FROM CHAL_MONTH
		<where>
			<if test="no != null">
		   		CHAL_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		CHAL_TITLE LIKE '%' || #{name} || '%'
			</if>
			<if test="point != null">
		   		CHAL_POINT LIKE '%' || #{point} || '%'
			</if>
		</where>
		ORDER BY CHAL_NO DESC
	</select>
	 
	<insert id="insertMonth" parameterType="Month"
	 	useGeneratedKeys="true" keyProperty="chalNo" keyColumn="CHAL_NO">
	 	INSERT INTO CHAL_MONTH(
	 		CHAL_NO,
	 		CATEGORY,
	 		CHAL_TITLE,
	 		CHAL_CONTENT,
	 		ORIGINAL_FILENAME,
	 		RENAMED_FILENAME,
	 		CHAL_POINT,
	 		CHAL_COUNT,
	 		START_DATE,
	 		END_DATE,
	 		CHAL_STATUS
	 	) VALUES(
	 		SEQ_CHAL_MONTH.NEXTVAL,
	 		#{category},
	 		#{chalTitle},
	 		#{chalContent},
	 		#{originalFilename},
	 		#{renamedFilename},
	 		#{chalPoint},
	 		#{chalCount},
	 		#{startDate},
	 		#{endDate},
	 		DEFAULT
	 	)
	 </insert>
	
	<update id="updateMonth" parameterType="Month">
	UPDATE CHAL_MONTH
	<trim prefix="SET" suffixOverrides=",">
	 	<if test="category != null">
	 		CATEGORY = #{category},
	 	</if>
	 	<if test="chalTitle != null">
	 		CHAL_TITLE = #{chalTitle},
		</if>
		<if test="chalContent != null">
	 		CHAL_CONTENT = #{chalContent},
		</if>
	 	<if test="originalFilename != null">
	 		ORIGINAL_FILENAME = #{originalFilename},
		</if>
		<if test="renamedFilename != null">
	 		RENAMED_FILENAME = #{renamedFilename},
		</if>
	 	<if test="chalPoint != null">
	 		CHAL_POINT = #{chalPoint},
	 	</if>
	 	<if test="chalCount != null">
	 		CHAL_COUNT = #{chalCount},
	 	</if>
	 	<if test="startDate != null">
	 		START_DATE = #{startDate},
		</if>
		<if test="endDate != null">
	 		END_DATE = #{endDate},
		</if>
		<if test="chalStatus != null">
	 		CHAL_STATUS = DEFAULT,
		</if>
	</trim>
	 	WHERE CHAL_NO = #{chalNo}
	</update>
	
<<<<<<< HEAD
	<update id="monthMemPoint" parameterType="_int">
	UPDATE CHAL_MONTH_MEM
	 	SET 
	 		CHAL_POINT_STATUS = 'Y'
	 	WHERE 
	 		NO = #{no}
	 </update>
	 
	<update id="todayMemPoint" parameterType="_int">
	UPDATE CHAL_TODAY_MEM
	 	SET 
	 		CHAL_POINT_STATUS = 'Y'
	 	WHERE 
	 		NO = #{no}
	 </update>
	 
	<update id="orderDelivery" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '배송완료'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	 
	<update id="reDelivery" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '결제완료'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	 
	<update id="cancelOrder" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '주문취소'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	 
	<select id="getReportedList" parameterType="map" resultMap="ReportedListResultMap">
		SELECT NO, 
		       MEMBER_TYPE, 
		       NAME, 
		       STATUS,
		       ENROLL_DATE,
		       (SELECT COUNT(NO) FROM REPORT WHERE (REPORTED_M_NO)=NO) AS REPORTED
			FROM MEMBER
			WHERE NO IN(SELECT REPORTED_M_NO
				        FROM REPORT)
		<choose>
		   	<when test="name != null">
		   		AND NAME LIKE '%' || #{name} || '%'
		   	</when>
		</choose>
			ORDER BY REPORTED DESC
	</select>
	
	<select id="getOrderListAll" parameterType="_int" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderDeliveryList" parameterType="_int" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '배송완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderCancelList" parameterType="map" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '주문취소'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="findDetailByNo" parameterType="_int" resultMap="OrderDetailResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			DETAIL_PRO_NO, 
			DETAIL_PRO_NAME, 
			DETAIL_OPT, 
			DETAIL_OPT_NAME, 
			DETAIL_QTY,
			DETAIL_PRICE
		FROM ORDER_DETAIL
		WHERE ORDER_NO = #{ no }
	</select>
	
	<select id="getOrderCountAll" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderDeliveryCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '배송완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderCancelCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '주문취소'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getReportDetail" parameterType="_int" resultMap="ReportListResultMap">
		<include refid="selectReportSql"/>
			FROM REPORT
			WHERE REPORT_NO = #{ no }
	</select>
	
	<select id="findProductByNo" parameterType="Product" resultMap="ProductListResultMap">
		<include refid="selectProductSql"/>
			FROM PRODUCT
			WHERE PRO_NO = #{ proNo }
	</select>
	
	<select id="findTodayByNo" parameterType="Today" resultMap="TodayListResultMap">
		SELECT 	CHAL_NO,
				CATEGORY,
				CHAL_TITLE,
				CHAL_CONTENT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				START_DATE,
				END_DATE
		FROM CHAL_TODAY
		WHERE CHAL_NO = #{ chalNo }
	</select>
	
=======
>>>>>>> 55942bd64bf01dbf60f9dfa0d267fe734ba077cd
	<select id="findMonthByNo" parameterType="Month" resultMap="MonthListResultMap">
		SELECT 	CHAL_NO,
				CATEGORY,
				CHAL_TITLE,
				CHAL_CONTENT,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				CHAL_COUNT,
				START_DATE,
				END_DATE
		FROM CHAL_MONTH
		WHERE CHAL_NO = #{ chalNo }
	</select>
  	
	<delete id="deleteMonth" parameterType="_int">
  		UPDATE CHAL_MONTH
  		SET
  			CHAL_STATUS = 'N'
  		WHERE 
  			CHAL_NO = #{no}
  	</delete>
	
	<select id="getTodayMemCount" resultType="_int">
		SELECT COUNT(*) FROM CHAL_MONTH_MEM
		<where>
			CHAL_POINT_STATUS = 'N'
			<if test="no != null">
		   		AND NO LIKE '%' || #{no} || '%'
			</if>
			<if test="memberNo != null">
		   		AND MEM_NO LIKE '%' || #{memberNo} || '%'
			</if>
			<if test="chalNo != null">
		   		AND CHAL_NO LIKE '%' || #{chalNo} || '%'
			</if>
		</where>
	</select>
	
	<select id="getTodayMemList" parameterType="map" resultMap="TodayMemListResultMap">
		SELECT  NO,
				MEM_NO,
				CHAL_NO,
				CHAL_STATUS,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				CHAL_POINT_STATUS,
				CHAL_DATE
		FROM CHAL_TODAY_MEM
		<where>
			CHAL_POINT_STATUS = 'N'
			<if test="no != null">
		   		AND NO LIKE '%' || #{no} || '%'
			</if>
			<if test="memberNo != null">
		   		AND MEM_NO LIKE '%' || #{memberNo} || '%'
			</if>
			<if test="chalNo != null">
		   		AND CHAL_NO LIKE '%' || #{chalNo} || '%'
			</if>
		</where>
		ORDER BY NO DESC
	</select>
  	
	<delete id="deleteTodayMem" parameterType="_int">
  		DELETE CHAL_TODAY_MEM
  		WHERE NO = #{no}
  	</delete>
	 
	<update id="todayMemPoint" parameterType="_int">
	UPDATE CHAL_TODAY_MEM
	 	SET 
	 		CHAL_POINT_STATUS = 'Y'
	 	WHERE 
	 		NO = #{no}
	 </update>
  	
	<delete id="banMember" parameterType="_int">
  		UPDATE MEMBER
  		SET
  			STATUS = 'N'
  		WHERE 
  			NO = (SELECT REPORTED_M_NO
                FROM REPORT
                WHERE REPORT_NO = #{ no })
  	</delete>
  	
  	<delete id="deleteBidding" parameterType="_int">
  		DELETE APPLICATION
  		WHERE 
  			APP_NO = #{no}
  	</delete>
  	
  	<update id="unbanMember" parameterType="_int">
	UPDATE MEMBER
	 	SET 
	 		STATUS = 'Y'
	 	WHERE 
	 		NO = #{no}
	 </update>
	
	<select id="getMonthMemCount" resultType="_int">
		SELECT COUNT(*) FROM CHAL_MONTH_MEM
		<where>
			CHAL_POINT_STATUS = 'N'
			<if test="no != null">
		   		AND NO LIKE '%' || #{no} || '%'
			</if>
			<if test="memberNo != null">
		   		AND MEM_NO LIKE '%' || #{memberNo} || '%'
			</if>
			<if test="chalNo != null">
		   		AND CHAL_NO LIKE '%' || #{chalNo} || '%'
			</if>
		</where>
	</select>
	
	<select id="getMonthMemList" parameterType="map" resultMap="MonthMemListResultMap">
		SELECT  NO,
				MEM_NO,
				CHAL_NO,
				CHAL_STATUS,
				ORIGINAL_FILENAME,
				RENAMED_FILENAME,
				CHAL_POINT,
				CHAL_POINT_STATUS,
				CHAL_DATE
		FROM CHAL_MONTH_MEM
		<where>
			CHAL_POINT_STATUS = 'N'
			<if test="no != null">
		   		AND NO LIKE '%' || #{no} || '%'
			</if>
			<if test="memberNo != null">
		   		AND MEM_NO LIKE '%' || #{memberNo} || '%'
			</if>
			<if test="chalNo != null">
		   		AND CHAL_NO LIKE '%' || #{chalNo} || '%'
			</if>
		</where>
		ORDER BY NO DESC
	</select>
	
	<delete id="deleteMonthMem" parameterType="_int">
  		DELETE CHAL_MONTH_MEM
  		WHERE NO = #{no}
  	</delete>
  	
	<update id="monthMemPoint" parameterType="_int">
	UPDATE CHAL_MONTH_MEM
	 	SET 
	 		CHAL_POINT_STATUS = 'Y'
	 	WHERE 
	 		NO = #{no}
	 </update>
	
	<select id="getProductCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT
		<where>
			<if test="proNo != null">
		   		PRO_NO LIKE '%' || #{proNo} || '%'
			</if>
			<if test="proName != null">
		   		PRO_NAME LIKE '%' || #{proName} || '%'
			</if>
			<if test="proStock != null">
		   		PRO_STOCK LIKE '%' || #{proStock} || '%'
			</if>
		</where>
	</select>
	
	<select id="getProductList" resultMap="ProductListResultMap">
		<include refid="selectProductSql"/>
		FROM PRODUCT
		<where>
			<if test="proNo != null">
		   		PRO_NO LIKE '%' || #{proNo} || '%'
			</if>
			<if test="proName != null">
		   		PRO_NAME LIKE '%' || #{proName} || '%'
			</if>
			<if test="proStock != null">
		   		PRO_STOCK LIKE '%' || #{proStock} || '%'
			</if>
		</where>
		<if test="proStock == null">
			ORDER BY PRO_NO DESC
		</if>
		<if test="proStock != null">
			ORDER BY PRO_STOCK
		</if>
	</select>
	
	<select id="findProductByNo" parameterType="Product" resultMap="ProductListResultMap">
		<include refid="selectProductSql"/>
			FROM PRODUCT
			WHERE PRO_NO = #{ proNo }
	</select>
	
	<insert id="insertProduct" parameterType="Product"
         useGeneratedKeys="true" keyProperty="proNo" keyColumn="PRO_NO">
         INSERT INTO PRODUCT(
             PRO_NO,
             PRO_NAME,
             PRO_PRICE,
             PRO_INFO,
             PRO_VOL,
             PRO_MODIFY_DATE,
             PRO_SOLD,
             PRO_MFG,
             PRO_IMG,
             PRO_STAT,
             PRO_CAT,
             PRO_DATE,
             PRO_STOCK,
             PRO_MODIFY_IMG
         ) VALUES(
             SEQ_PRONO.NEXTVAL,
             #{proName},
             #{proPrice},
             #{proInfo},
             #{proVol},
             DEFAULT,
            0,
            #{proMfg},
             #{proImg},
             #{proStat},
             #{proCat},
             DEFAULT,
             #{proStock},
             #{proModifyImg}
         )
     </insert>
	 
	 <insert id="productImgsSave" parameterType="productImgs">
         INSERT INTO PRODUCT_IMGS (
            PRO_NO,
            ORIGINAL_FILENAME,
            RENAMED_FILENAME
        ) VALUES (
            #{proNo},
            #{originalFileName},
            #{renamedFileName}
        )
     </insert>
	
	<update id="updateProduct" parameterType="Product">
	UPDATE PRODUCT
	<trim prefix="SET" suffixOverrides=",">
	 	<if test="proName != null">
	 		PRO_NAME = #{proName},
	 	</if>
	 	<if test="proPrice != null">
	 		PRO_PRICE = #{proPrice},
		</if>
		<if test="proVol != null">
	 		PRO_VOL = #{proVol},
		</if>
	 	<if test="proModifyImg != null">
	 		PRO_MODIFY_IMG = #{proModifyImg},
		</if>
		<if test="proInfo != null">
	 		PRO_INFO = #{proInfo},
		</if>
	 	<if test="proStat != null">
	 		PRO_STAT = #{proStat},
	 	</if>
	 	<if test="proCat != null">
	 		PRO_CAT = #{proCat},
		</if>
		<if test="proStock != null">
	 		PRO_STOCK = #{proStock},
		</if>
	 	<if test="proSold != null">
	 		PRO_SOLD = #{proSold},
	 	</if>
	 	<if test="proMfg != null">
	 		PRO_MFG = #{proMfg},
		</if>
	 		PRO_MODIFY_DATE=SYSDATE
	</trim>
	 	WHERE
	 		PRO_NO = #{proNo}
	 </update>
	
	<select id="getOrderCountAll" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderListAll" parameterType="_int" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '결제완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderDeliveryCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '배송완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderDeliveryList" parameterType="_int" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '배송완료'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	 
	<update id="orderDelivery" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '배송완료'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	
	<select id="getOrderCancelCount" parameterType="map" resultType="_int">
		SELECT COUNT(*)
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '주문취소'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	
	<select id="getOrderCancelList" parameterType="map" resultMap="OrderSumResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			ORDER_PRICE, 
			ORDER_STAT, 
			ORDER_DATE, 
			ORDER_METHOD, 
			ORDER_POINT
		FROM ORDER_SUM
		<where>
			ORDER_STAT = '주문취소'
			<if test="no != null">
		   		AND ORDER_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="name != null">
		   		AND MEMBER_NO LIKE '%' || #{name} || '%'
			</if>
		</where>
	</select>
	 
	<update id="cancelOrder" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '주문취소'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	 
	<update id="reDelivery" parameterType="_int">
	UPDATE ORDER_SUM
	 	SET 
	 		ORDER_STAT = '결제완료'
	 	WHERE 
	 		ORDER_NO = #{orderNo}
	 </update>
	
	<select id="findDetailByNo" parameterType="_int" resultMap="OrderDetailResultMap">
		SELECT 
			ORDER_NO,
			MEMBER_NO, 
			DETAIL_PRO_NO, 
			DETAIL_PRO_NAME, 
			DETAIL_OPT, 
			DETAIL_OPT_NAME, 
			DETAIL_QTY,
			DETAIL_PRICE
		FROM ORDER_DETAIL
		WHERE ORDER_NO = #{ no }
	</select>
	 
	 <select id="getApplicationCount" resultType="_int">
         SELECT COUNT(*)
        FROM APPLICATION
     </select>

     <select id="getApplicationList" parameterType="string" resultMap="ApplicationListResultMap">
         SELECT A.APP_NO AS A_APP_NO, 
               A.MEMBER_NO AS A_MEMBER_NO, 
               A.APP_NAME AS A_APP_NAME, 
               A.APP_URL AS A_APP_URL, 
               A.APP_TITLE AS A_APP_TITLE, 
               A.APP_CONTENT AS A_APP_CONTENT, 
               A.APP_S_NO AS A_APP_S_NO, 
               A.APP_C_NO AS A_APP_C_NO, 
               A.APP_DATE AS A_APP_DATE,
               P.C_NAME AS P_C_NAME
        FROM APPLICATION A
        JOIN PRODUCT_CATEGORY P ON(A.APP_C_NO = P.C_NO)
        <where>
            <if test="select == '모집중'">
                AND APP_S_NO = 1
            </if>
            <if test="select == '모집대기'">
                AND APP_S_NO = 0
            </if>
        </where>
     </select>

     <insert id="biddingSave" parameterType="ProductBidding"
             useGeneratedKeys="true" keyProperty="bidNo" keyColumn="BID_NO">
         INSERT INTO PRODUCT_BIDDING (
            BID_NO,
            BID_NAME,
            BID_COND,
            BID_CURR,
            BID_S_NO,
            BID_URL,
            ORIGINAL_FILENAME,
            RENAMED_FILENAME
            ) VALUES (
            SEQ_BIDNO.NEXTVAL,
            #{bidName},
            #{bidCond},
            #{bidCurr},
            #{bidStatNo},
            #{bidUrl},
            #{originalFileName},
            #{renamedFileName}
            )
     </insert>

     <update id="updateApplication" parameterType="_int">
         UPDATE APPLICATION
        SET APP_S_NO = 1
        WHERE APP_NO = #{appNo}
     </update>
	
	<select id="getProInqCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT_INQUIRY
		<where>
			<if test="no != null">
		   		INQ_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="proNo != null">
		   		PRO_NO LIKE '%' || #{proNo} || '%'
			</if>
		</where>
	</select>
	
	<select id="getProInqList" resultMap="ProductInqListResultMap">
		SELECT PRO_NO,
				MEMBER_NO,
				INQ_NO,
				INQ_DATE,
				INQ_MOD_DATE,
				INQ_TITLE,
				INQ_CONTENT,
				INQ_STAT,
				INQ_SECRET
		FROM PRODUCT_INQUIRY
		<where>
			<if test="no != null">
		   		INQ_NO LIKE '%' || #{no} || '%'
			</if>
			<if test="proNo != null">
		   		PRO_NO LIKE '%' || #{proNo} || '%'
			</if>
		</where>
		ORDER BY DECODE(INQ_STAT, 'N', 1), INQ_NO DESC
	</select>
     
     <select id="findProInqByNo" parameterType="_int" resultMap="ProductInqListResultMap">
         SELECT PRO_NO, 
                MEMBER_NO, 
                INQ_NO, 
                INQ_DATE, 
                INQ_MOD_DATE, 
                INQ_TITLE, 
                INQ_CONTENT, 
                INQ_STAT
        FROM PRODUCT_INQUIRY
        WHERE INQ_NO = #{no}
     </select>

     <insert id="answerProInq" parameterType="ProInqAnswer">
         INSERT INTO PRO_INQ_ANSWER (
            PRO_NO,
            MEMBER_NO,
            INQ_NO,
            INQ_ANS,
            INQ_ANS_DATE
        ) VALUES (
            #{proNo},
            #{memberNo},
            #{inqNo},
            #{inqAns},
            DEFAULT
        )
     </insert>

     <update id="updateProInq" parameterType="_int">
         UPDATE PRODUCT_INQUIRY
         SET INQ_STAT = 'Y'
         WHERE INQ_NO = #{no}
     </update>
	 
</mapper>